(ns wellness2tcx-cljs.core
  (:require [reagent.core :as reagent :refer [atom]]
            [wellness2tcx-cljs.convert :as conv]
            [wellness2tcx-cljs.emit :as emit]
            [wellness2tcx-cljs.utils :refer [download]]))

(enable-console-print!)

(println "This text is printed from src/wellness2tcx-cljs/core.cljs. Go ahead and edit it and see reloading in action.")

;; define your app data so that it doesn't get over-written on reload

(defonce app-state (atom {:input-value        "{\"data\":{\"analitics\":{\"descriptor\":[{\"i\":0,\"pr\":{\"name\":\"Power\",\"um\":\"Watt\"}},{\"i\":1,\"pr\":{\"name\":\"Rpm\",\"um\":\"Rpm\"}},{\"i\":2,\"pr\":{\"name\":\"Speed\",\"um\":\"Km_h\"}},{\"i\":3,\"pr\":{\"name\":\"HDistance\",\"um\":\"Meter\"}},{\"i\":4,\"pr\":{\"name\":\"Level\",\"um\":\"Number\"}}],\"samples\":[{\"vs\":[368.0,102.0,39.0,100.0,10.0],\"t\":5},{\"vs\":[369.0,101.0,39.0,200.0,10.0],\"t\":10},{\"vs\":[361.0,100.0,39.0,200.0,10.0],\"t\":15},{\"vs\":[360.0,100.0,39.0,300.0,10.0],\"t\":20},{\"vs\":[366.0,101.0,39.0,300.0,10.0],\"t\":25},{\"vs\":[357.0,99.0,38.0,400.0,10.0],\"t\":30},{\"vs\":[358.0,99.0,38.0,400.0,10.0],\"t\":35},{\"vs\":[359.0,96.0,38.0,500.0,10.0],\"t\":40},{\"vs\":[357.0,93.0,38.0,500.0,10.0],\"t\":45},{\"vs\":[360.0,94.0,39.0,600.0,10.0],\"t\":50},{\"vs\":[355.0,92.0,38.0,600.0,10.0],\"t\":55},{\"vs\":[367.0,95.0,39.0,600.0,10.0],\"t\":60},{\"vs\":[364.0,94.0,39.0,800.0,10.0],\"t\":65},{\"vs\":[361.0,94.0,39.0,800.0,10.0],\"t\":70},{\"vs\":[359.0,93.0,38.0,800.0,10.0],\"t\":75},{\"vs\":[363.0,94.0,39.0,800.0,10.0],\"t\":80},{\"vs\":[362.0,94.0,39.0,1000.0,10.0],\"t\":85},{\"vs\":[364.0,94.0,39.0,1000.0,10.0],\"t\":90},{\"vs\":[356.0,93.0,38.0,1100.0,10.0],\"t\":95},{\"vs\":[364.0,94.0,39.0,1100.0,10.0],\"t\":100},{\"vs\":[363.0,94.0,39.0,1200.0,10.0],\"t\":105},{\"vs\":[352.0,96.0,38.0,1200.0,10.0],\"t\":110},{\"vs\":[357.0,97.0,38.0,1200.0,10.0],\"t\":115},{\"vs\":[357.0,97.0,38.0,1300.0,10.0],\"t\":125},{\"vs\":[353.0,96.0,38.0,1500.0,10.0],\"t\":130},{\"vs\":[349.0,95.0,38.0,1500.0,11.0],\"t\":135},{\"vs\":[352.0,88.0,38.0,1600.0,11.0],\"t\":140},{\"vs\":[352.0,86.0,38.0,1600.0,11.0],\"t\":145},{\"vs\":[359.0,87.0,38.0,1700.0,11.0],\"t\":150},{\"vs\":[360.0,87.0,39.0,1700.0,11.0],\"t\":155},{\"vs\":[358.0,87.0,38.0,1700.0,11.0],\"t\":160},{\"vs\":[357.0,87.0,38.0,1700.0,11.0],\"t\":165},{\"vs\":[365.0,88.0,39.0,1800.0,11.0],\"t\":170},{\"vs\":[358.0,87.0,38.0,2000.0,11.0],\"t\":180},{\"vs\":[364.0,88.0,39.0,2000.0,11.0],\"t\":185},{\"vs\":[359.0,87.0,38.0,2000.0,11.0],\"t\":190},{\"vs\":[357.0,87.0,38.0,2200.0,11.0],\"t\":195},{\"vs\":[354.0,87.0,38.0,2200.0,11.0],\"t\":200},{\"vs\":[355.0,86.0,38.0,2200.0,11.0],\"t\":205},{\"vs\":[367.0,88.0,39.0,2200.0,11.0],\"t\":210},{\"vs\":[366.0,88.0,39.0,2400.0,11.0],\"t\":215},{\"vs\":[369.0,88.0,39.0,2400.0,11.0],\"t\":220},{\"vs\":[364.0,87.0,39.0,2500.0,11.0],\"t\":225},{\"vs\":[366.0,87.0,39.0,2500.0,11.0],\"t\":230},{\"vs\":[322.0,87.0,37.0,2500.0,3.0],\"t\":235},{\"vs\":[354.0,91.0,38.0,2500.0,10.0],\"t\":240},{\"vs\":[344.0,92.0,38.0,2700.0,10.0],\"t\":245},{\"vs\":[355.0,94.0,38.0,2700.0,10.0],\"t\":250},{\"vs\":[353.0,94.0,38.0,2700.0,10.0],\"t\":255},{\"vs\":[344.0,93.0,38.0,2900.0,10.0],\"t\":260},{\"vs\":[308.0,96.0,36.0,2900.0,10.0],\"t\":265},{\"vs\":[337.0,100.0,37.0,3000.0,10.0],\"t\":270},{\"vs\":[322.0,97.0,37.0,3000.0,10.0],\"t\":275},{\"vs\":[337.0,95.0,37.0,3000.0,10.0],\"t\":280},{\"vs\":[338.0,95.0,38.0,3000.0,10.0],\"t\":285},{\"vs\":[342.0,96.0,38.0,3200.0,10.0],\"t\":290},{\"vs\":[340.0,95.0,38.0,3200.0,10.0],\"t\":295},{\"vs\":[341.0,95.0,38.0,3200.0,10.0],\"t\":305},{\"vs\":[359.0,98.0,38.0,3400.0,10.0],\"t\":310},{\"vs\":[350.0,97.0,38.0,3400.0,10.0],\"t\":315},{\"vs\":[346.0,96.0,38.0,3500.0,10.0],\"t\":320},{\"vs\":[365.0,98.0,39.0,3500.0,10.0],\"t\":325},{\"vs\":[350.0,96.0,38.0,3500.0,10.0],\"t\":330},{\"vs\":[348.0,96.0,38.0,3700.0,10.0],\"t\":335},{\"vs\":[355.0,97.0,38.0,3700.0,10.0],\"t\":340},{\"vs\":[351.0,96.0,38.0,3700.0,10.0],\"t\":345},{\"vs\":[356.0,97.0,38.0,3700.0,10.0],\"t\":350},{\"vs\":[361.0,98.0,39.0,3900.0,10.0],\"t\":355},{\"vs\":[345.0,95.0,38.0,3900.0,10.0],\"t\":360},{\"vs\":[348.0,96.0,38.0,4000.0,10.0],\"t\":365},{\"vs\":[338.0,94.0,38.0,4000.0,10.0],\"t\":370},{\"vs\":[347.0,96.0,38.0,4000.0,10.0],\"t\":375},{\"vs\":[355.0,97.0,38.0,4000.0,10.0],\"t\":380},{\"vs\":[353.0,97.0,38.0,4100.0,10.0],\"t\":385},{\"vs\":[349.0,96.0,38.0,4100.0,10.0],\"t\":390},{\"vs\":[353.0,96.0,38.0,4300.0,10.0],\"t\":395},{\"vs\":[351.0,96.0,38.0,4300.0,10.0],\"t\":400},{\"vs\":[349.0,96.0,38.0,4400.0,10.0],\"t\":405},{\"vs\":[342.0,95.0,38.0,4500.0,10.0],\"t\":410},{\"vs\":[348.0,96.0,38.0,4500.0,10.0],\"t\":415},{\"vs\":[341.0,95.0,38.0,4500.0,10.0],\"t\":420},{\"vs\":[357.0,97.0,38.0,4500.0,10.0],\"t\":425},{\"vs\":[352.0,96.0,38.0,4600.0,10.0],\"t\":430},{\"vs\":[353.0,97.0,38.0,4600.0,10.0],\"t\":435},{\"vs\":[358.0,97.0,38.0,4800.0,10.0],\"t\":440},{\"vs\":[357.0,97.0,38.0,4800.0,10.0],\"t\":445},{\"vs\":[368.0,99.0,39.0,4900.0,10.0],\"t\":450},{\"vs\":[354.0,97.0,38.0,4900.0,10.0],\"t\":455},{\"vs\":[348.0,96.0,38.0,5000.0,10.0],\"t\":460},{\"vs\":[349.0,96.0,38.0,5000.0,10.0],\"t\":465},{\"vs\":[344.0,95.0,38.0,5000.0,10.0],\"t\":470},{\"vs\":[346.0,95.0,38.0,5100.0,10.0],\"t\":475},{\"vs\":[344.0,95.0,38.0,5100.0,10.0],\"t\":480},{\"vs\":[351.0,96.0,38.0,5300.0,10.0],\"t\":485},{\"vs\":[343.0,95.0,38.0,5300.0,10.0],\"t\":490},{\"vs\":[320.0,93.0,37.0,5400.0,10.0],\"t\":495},{\"vs\":[329.0,95.0,37.0,5400.0,10.0],\"t\":500},{\"vs\":[329.0,95.0,37.0,5500.0,10.0],\"t\":505},{\"vs\":[327.0,94.0,37.0,5500.0,10.0],\"t\":510},{\"vs\":[335.0,96.0,37.0,5500.0,10.0],\"t\":515},{\"vs\":[344.0,97.0,38.0,5500.0,10.0],\"t\":520},{\"vs\":[357.0,99.0,38.0,5600.0,10.0],\"t\":525},{\"vs\":[356.0,99.0,38.0,5600.0,10.0],\"t\":530},{\"vs\":[357.0,99.0,38.0,5800.0,10.0],\"t\":535},{\"vs\":[360.0,100.0,39.0,5800.0,10.0],\"t\":540},{\"vs\":[357.0,100.0,38.0,5900.0,10.0],\"t\":545},{\"vs\":[349.0,94.0,38.0,6000.0,11.0],\"t\":550},{\"vs\":[337.0,78.0,37.0,6000.0,11.0],\"t\":555},{\"vs\":[318.0,77.0,37.0,6000.0,11.0],\"t\":560},{\"vs\":[304.0,82.0,36.0,6000.0,10.0],\"t\":565},{\"vs\":[254.0,82.0,33.0,6100.0,10.0],\"t\":570},{\"vs\":[254.0,81.0,33.0,6100.0,10.0],\"t\":575},{\"vs\":[297.0,89.0,36.0,6100.0,10.0],\"t\":580},{\"vs\":[301.0,90.0,36.0,6300.0,10.0],\"t\":585},{\"vs\":[192.0,94.0,29.0,6300.0,8.0],\"t\":590},{\"vs\":[194.0,95.0,29.0,6400.0,8.0],\"t\":595},{\"vs\":[176.0,90.0,28.0,6400.0,8.0],\"t\":600},{\"vs\":[169.0,88.0,28.0,6500.0,8.0],\"t\":605},{\"vs\":[188.0,93.0,29.0,6500.0,8.0],\"t\":610},{\"vs\":[186.0,93.0,29.0,6500.0,8.0],\"t\":615},{\"vs\":[210.0,92.0,31.0,6500.0,8.0],\"t\":620},{\"vs\":[211.0,92.0,31.0,6500.0,8.0],\"t\":625},{\"vs\":[205.0,90.0,30.0,6600.0,8.0],\"t\":630},{\"vs\":[198.0,88.0,30.0,6600.0,8.0],\"t\":635},{\"vs\":[195.0,88.0,30.0,6800.0,8.0],\"t\":640},{\"vs\":[209.0,91.0,30.0,6800.0,8.0],\"t\":645},{\"vs\":[216.0,93.0,31.0,6800.0,8.0],\"t\":650},{\"vs\":[218.0,94.0,31.0,6900.0,8.0],\"t\":655},{\"vs\":[219.0,94.0,31.0,6900.0,8.0],\"t\":660},{\"vs\":[214.0,93.0,31.0,7000.0,8.0],\"t\":665},{\"vs\":[221.0,94.0,31.0,7000.0,8.0],\"t\":670},{\"vs\":[212.0,92.0,31.0,7000.0,8.0],\"t\":675},{\"vs\":[213.0,93.0,31.0,7000.0,8.0],\"t\":680},{\"vs\":[221.0,95.0,31.0,7100.0,8.0],\"t\":685},{\"vs\":[204.0,81.0,30.0,7100.0,10.0],\"t\":690},{\"vs\":[237.0,81.0,32.0,7100.0,10.0],\"t\":695},{\"vs\":[244.0,82.0,33.0,7300.0,10.0],\"t\":700},{\"vs\":[246.0,83.0,33.0,7300.0,10.0],\"t\":705},{\"vs\":[225.0,78.0,32.0,7400.0,10.0],\"t\":710},{\"vs\":[218.0,77.0,31.0,7400.0,10.0],\"t\":715},{\"vs\":[222.0,78.0,31.0,7500.0,10.0],\"t\":720},{\"vs\":[221.0,78.0,31.0,7500.0,10.0],\"t\":725},{\"vs\":[221.0,77.0,31.0,7500.0,10.0],\"t\":730},{\"vs\":[215.0,77.0,31.0,7500.0,10.0],\"t\":735},{\"vs\":[216.0,77.0,31.0,7500.0,10.0],\"t\":740},{\"vs\":[214.0,76.0,31.0,7600.0,10.0],\"t\":745},{\"vs\":[215.0,77.0,31.0,7600.0,10.0],\"t\":750},{\"vs\":[218.0,77.0,31.0,7800.0,10.0],\"t\":755},{\"vs\":[220.0,77.0,31.0,7800.0,10.0],\"t\":760},{\"vs\":[201.0,82.0,30.0,7900.0,9.0],\"t\":765},{\"vs\":[204.0,83.0,30.0,7900.0,9.0],\"t\":770},{\"vs\":[207.0,84.0,30.0,7900.0,9.0],\"t\":775},{\"vs\":[208.0,84.0,30.0,8000.0,9.0],\"t\":780},{\"vs\":[200.0,83.0,30.0,8000.0,9.0],\"t\":785},{\"vs\":[195.0,82.0,30.0,8100.0,9.0],\"t\":790},{\"vs\":[206.0,84.0,30.0,8100.0,9.0],\"t\":795},{\"vs\":[207.0,84.0,30.0,8100.0,9.0],\"t\":800},{\"vs\":[214.0,85.0,31.0,8100.0,9.0],\"t\":805},{\"vs\":[218.0,86.0,31.0,8100.0,9.0],\"t\":810},{\"vs\":[220.0,87.0,31.0,8300.0,9.0],\"t\":815},{\"vs\":[223.0,88.0,31.0,8300.0,9.0],\"t\":820},{\"vs\":[227.0,89.0,32.0,8300.0,9.0],\"t\":825},{\"vs\":[225.0,88.0,32.0,8300.0,9.0],\"t\":830},{\"vs\":[224.0,88.0,31.0,8500.0,9.0],\"t\":835},{\"vs\":[225.0,88.0,32.0,8500.0,9.0],\"t\":840},{\"vs\":[225.0,88.0,32.0,8600.0,9.0],\"t\":850},{\"vs\":[219.0,87.0,31.0,8600.0,9.0],\"t\":855},{\"vs\":[218.0,87.0,31.0,8600.0,9.0],\"t\":860},{\"vs\":[228.0,89.0,32.0,8600.0,9.0],\"t\":865},{\"vs\":[220.0,87.0,31.0,8800.0,9.0],\"t\":870},{\"vs\":[226.0,88.0,32.0,8800.0,9.0],\"t\":875},{\"vs\":[209.0,87.0,30.0,8800.0,8.0],\"t\":880},{\"vs\":[195.0,88.0,30.0,8800.0,8.0],\"t\":885},{\"vs\":[205.0,90.0,30.0,8800.0,8.0],\"t\":890},{\"vs\":[208.0,91.0,30.0,9000.0,8.0],\"t\":895},{\"vs\":[210.0,92.0,31.0,9000.0,8.0],\"t\":900},{\"vs\":[201.0,90.0,30.0,9100.0,8.0],\"t\":905},{\"vs\":[194.0,88.0,29.0,9100.0,8.0],\"t\":910},{\"vs\":[187.0,86.0,29.0,9100.0,8.0],\"t\":915},{\"vs\":[188.0,86.0,29.0,9100.0,8.0],\"t\":920},{\"vs\":[179.0,84.0,28.0,9100.0,8.0],\"t\":925},{\"vs\":[179.0,84.0,28.0,9300.0,8.0],\"t\":930},{\"vs\":[184.0,85.0,29.0,9300.0,8.0],\"t\":935},{\"vs\":[183.0,85.0,29.0,9300.0,8.0],\"t\":940},{\"vs\":[199.0,89.0,30.0,9300.0,8.0],\"t\":945},{\"vs\":[209.0,92.0,30.0,9300.0,8.0],\"t\":950},{\"vs\":[206.0,91.0,30.0,9500.0,8.0],\"t\":955},{\"vs\":[210.0,92.0,31.0,9500.0,8.0],\"t\":960},{\"vs\":[203.0,90.0,30.0,19000.0,8.0],\"t\":969},{\"vs\":[202.0,90.0,30.0,19100.0,8.0],\"t\":974},{\"vs\":[204.0,91.0,30.0,19100.0,8.0],\"t\":979},{\"vs\":[199.0,90.0,30.0,19200.0,8.0],\"t\":984},{\"vs\":[210.0,92.0,31.0,19200.0,8.0],\"t\":989},{\"vs\":[202.0,90.0,30.0,19300.0,8.0],\"t\":994},{\"vs\":[212.0,92.0,31.0,19300.0,8.0],\"t\":999},{\"vs\":[209.0,91.0,30.0,19300.0,8.0],\"t\":1004},{\"vs\":[209.0,92.0,30.0,19400.0,8.0],\"t\":1009},{\"vs\":[205.0,90.0,30.0,19400.0,8.0],\"t\":1014},{\"vs\":[203.0,90.0,30.0,19500.0,8.0],\"t\":1019},{\"vs\":[213.0,92.0,31.0,19500.0,8.0],\"t\":1024},{\"vs\":[209.0,92.0,30.0,19600.0,8.0],\"t\":1029},{\"vs\":[204.0,90.0,30.0,19600.0,8.0],\"t\":1034},{\"vs\":[192.0,88.0,29.0,19600.0,8.0],\"t\":1039},{\"vs\":[183.0,85.0,29.0,19600.0,8.0],\"t\":1044},{\"vs\":[178.0,84.0,28.0,19600.0,8.0],\"t\":1049},{\"vs\":[177.0,83.0,28.0,19800.0,8.0],\"t\":1054},{\"vs\":[171.0,82.0,28.0,19800.0,8.0],\"t\":1059},{\"vs\":[175.0,83.0,28.0,19800.0,8.0],\"t\":1064},{\"vs\":[181.0,85.0,29.0,19800.0,8.0],\"t\":1069},{\"vs\":[177.0,83.0,28.0,19800.0,8.0],\"t\":1074},{\"vs\":[176.0,83.0,28.0,20000.0,8.0],\"t\":1079},{\"vs\":[175.0,83.0,28.0,20000.0,8.0],\"t\":1084},{\"vs\":[177.0,84.0,28.0,20100.0,8.0],\"t\":1094},{\"vs\":[179.0,84.0,28.0,20100.0,8.0],\"t\":1099},{\"vs\":[161.0,80.0,27.0,20200.0,8.0],\"t\":1104},{\"vs\":[166.0,80.0,27.0,20200.0,8.0],\"t\":1109},{\"vs\":[186.0,85.0,29.0,20200.0,8.0],\"t\":1114},{\"vs\":[176.0,84.0,28.0,20200.0,8.0],\"t\":1119},{\"vs\":[152.0,77.0,26.0,20200.0,8.0],\"t\":1124},{\"vs\":[170.0,81.0,28.0,20300.0,8.0],\"t\":1129},{\"vs\":[197.0,88.0,30.0,20300.0,8.0],\"t\":1134},{\"vs\":[193.0,88.0,29.0,20300.0,8.0],\"t\":1139},{\"vs\":[204.0,90.0,30.0,20500.0,8.0],\"t\":1144},{\"vs\":[190.0,88.0,29.0,20500.0,8.0],\"t\":1149},{\"vs\":[190.0,87.0,29.0,20600.0,8.0],\"t\":1154},{\"vs\":[182.0,84.0,29.0,20600.0,8.0],\"t\":1159},{\"vs\":[188.0,86.0,29.0,20600.0,8.0],\"t\":1164},{\"vs\":[183.0,85.0,29.0,20700.0,8.0],\"t\":1169},{\"vs\":[177.0,84.0,28.0,20700.0,8.0],\"t\":1174},{\"vs\":[160.0,91.0,27.0,20700.0,7.0],\"t\":1179},{\"vs\":[158.0,91.0,27.0,20700.0,7.0],\"t\":1184},{\"vs\":[153.0,89.0,26.0,20700.0,7.0],\"t\":1189},{\"vs\":[152.0,89.0,26.0,20800.0,7.0],\"t\":1194},{\"vs\":[154.0,90.0,26.0,20800.0,7.0],\"t\":1199}],\"hr\":[{\"hr\":153,\"t\":5},{\"hr\":159,\"t\":10},{\"hr\":163,\"t\":15},{\"hr\":167,\"t\":20},{\"hr\":170,\"t\":25},{\"hr\":171,\"t\":30},{\"hr\":170,\"t\":35},{\"hr\":171,\"t\":45},{\"hr\":172,\"t\":55},{\"hr\":173,\"t\":60},{\"hr\":174,\"t\":70},{\"hr\":175,\"t\":75},{\"hr\":174,\"t\":80},{\"hr\":175,\"t\":90},{\"hr\":174,\"t\":110},{\"hr\":175,\"t\":125},{\"hr\":176,\"t\":135},{\"hr\":175,\"t\":155},{\"hr\":176,\"t\":160},{\"hr\":177,\"t\":175},{\"hr\":176,\"t\":185},{\"hr\":177,\"t\":190},{\"hr\":176,\"t\":195},{\"hr\":175,\"t\":210},{\"hr\":177,\"t\":215},{\"hr\":175,\"t\":245},{\"hr\":176,\"t\":250},{\"hr\":177,\"t\":255},{\"hr\":176,\"t\":270},{\"hr\":177,\"t\":290},{\"hr\":176,\"t\":295},{\"hr\":177,\"t\":300},{\"hr\":176,\"t\":305},{\"hr\":177,\"t\":310},{\"hr\":178,\"t\":315},{\"hr\":179,\"t\":335},{\"hr\":178,\"t\":340},{\"hr\":179,\"t\":345},{\"hr\":180,\"t\":350},{\"hr\":179,\"t\":355},{\"hr\":180,\"t\":360},{\"hr\":179,\"t\":365},{\"hr\":180,\"t\":385},{\"hr\":181,\"t\":410},{\"hr\":180,\"t\":415},{\"hr\":181,\"t\":420},{\"hr\":180,\"t\":425},{\"hr\":182,\"t\":440},{\"hr\":181,\"t\":455},{\"hr\":182,\"t\":465},{\"hr\":181,\"t\":490},{\"hr\":180,\"t\":495},{\"hr\":181,\"t\":500},{\"hr\":180,\"t\":510},{\"hr\":181,\"t\":515},{\"hr\":182,\"t\":535},{\"hr\":181,\"t\":540},{\"hr\":182,\"t\":545},{\"hr\":181,\"t\":560},{\"hr\":180,\"t\":565},{\"hr\":179,\"t\":570},{\"hr\":178,\"t\":575},{\"hr\":179,\"t\":585},{\"hr\":177,\"t\":595},{\"hr\":175,\"t\":600},{\"hr\":173,\"t\":610},{\"hr\":172,\"t\":615},{\"hr\":169,\"t\":620},{\"hr\":168,\"t\":625},{\"hr\":166,\"t\":630},{\"hr\":167,\"t\":635},{\"hr\":168,\"t\":645},{\"hr\":167,\"t\":655},{\"hr\":166,\"t\":660},{\"hr\":165,\"t\":665},{\"hr\":164,\"t\":670},{\"hr\":162,\"t\":675},{\"hr\":161,\"t\":700},{\"hr\":162,\"t\":705},{\"hr\":163,\"t\":715},{\"hr\":165,\"t\":725},{\"hr\":166,\"t\":735},{\"hr\":165,\"t\":755},{\"hr\":164,\"t\":765},{\"hr\":163,\"t\":770},{\"hr\":161,\"t\":780},{\"hr\":160,\"t\":785},{\"hr\":161,\"t\":800},{\"hr\":162,\"t\":805},{\"hr\":161,\"t\":810},{\"hr\":160,\"t\":820},{\"hr\":161,\"t\":830},{\"hr\":160,\"t\":840},{\"hr\":161,\"t\":845},{\"hr\":162,\"t\":875},{\"hr\":161,\"t\":900},{\"hr\":160,\"t\":905},{\"hr\":161,\"t\":920},{\"hr\":162,\"t\":925},{\"hr\":161,\"t\":935},{\"hr\":160,\"t\":950},{\"hr\":159,\"t\":955},{\"hr\":157,\"t\":969},{\"hr\":158,\"t\":974},{\"hr\":159,\"t\":984},{\"hr\":158,\"t\":989},{\"hr\":159,\"t\":1019},{\"hr\":160,\"t\":1029},{\"hr\":161,\"t\":1059},{\"hr\":162,\"t\":1064},{\"hr\":161,\"t\":1069},{\"hr\":162,\"t\":1074},{\"hr\":161,\"t\":1079},{\"hr\":160,\"t\":1089},{\"hr\":161,\"t\":1099},{\"hr\":157,\"t\":1109},{\"hr\":155,\"t\":1114},{\"hr\":153,\"t\":1129},{\"hr\":154,\"t\":1139},{\"hr\":155,\"t\":1144},{\"hr\":154,\"t\":1154},{\"hr\":155,\"t\":1159},{\"hr\":156,\"t\":1164},{\"hr\":157,\"t\":1169},{\"hr\":155,\"t\":1184},{\"hr\":153,\"t\":1189},{\"hr\":152,\"t\":1194}],\"hrZones\":[{\"secondsInZone\":0.0,\"name\":\"Very light\",\"color\":\"#0085BA\",\"upperBound\":115.0,\"lowerBound\":96.0},{\"secondsInZone\":0.0,\"name\":\"Light\",\"color\":\"#26DD70\",\"upperBound\":134.0,\"lowerBound\":116.0},{\"secondsInZone\":29.0,\"name\":\"Moderate\",\"color\":\"#FFDD00\",\"upperBound\":153.0,\"lowerBound\":135.0},{\"secondsInZone\":614.0,\"name\":\"Hard\",\"color\":\"#FC8F00\",\"upperBound\":172.0,\"lowerBound\":154.0},{\"secondsInZone\":555.0,\"name\":\"Very hard\",\"color\":\"#CE2929\",\"upperBound\":191.0,\"lowerBound\":173.0}],\"powerZones\":[{\"secondsInZone\":0.0,\"name\":\"Very light\",\"color\":\"#0085BA\",\"upperBound\":80.0,\"lowerBound\":0.0},{\"secondsInZone\":0.0,\"name\":\"Light\",\"color\":\"#26DD70\",\"upperBound\":110.0,\"lowerBound\":81.0},{\"secondsInZone\":0.0,\"name\":\"Moderate\",\"color\":\"#FFDD00\",\"upperBound\":131.0,\"lowerBound\":111.0},{\"secondsInZone\":15.0,\"name\":\"Hard\",\"color\":\"#FC8F00\",\"upperBound\":153.0,\"lowerBound\":132.0},{\"secondsInZone\":1186.0,\"name\":\"Very hard\",\"color\":\"#CE2929\",\"upperBound\":292.0,\"lowerBound\":154.0}]},\"equipmentType\":\"UprightBike\",\"cardioLogId\":\"5ccb12340d87e30b24de93c6\",\"favorite\":0,\"name\":\"Functional Threshold Power Test\",\"date\":\"2019-05-02\",\"target\":\"Duration\",\"nEser\":6102,\"nAttr\":995,\"physicalActivityId\":\"\",\"physicalActivityName\":\"Functional Threshold Power Test\",\"data\":[{\"property\":\"Duration\",\"name\":\"Varaktighet\",\"value\":\"20:02\",\"uM\":\"min\",\"rawValue\":20.03},{\"property\":\"HDistance\",\"name\":\"Distans\",\"value\":\"1,8\",\"uM\":\"km\",\"rawValue\":1.8},{\"property\":\"Move\",\"name\":\"MOVEs\",\"value\":\"691\",\"uM\":\"MOVEs\",\"rawValue\":691.0}]},\"token\":\"\",\"version\":\"1.1.101.26957\",\"expireIn\":3600}"
                          :starttime:hh:mm:ss "12:00:00"}))


(defn json-input [app-state]
  [:input {:type      "text"
           :value     (get @app-state :input-value)
           :on-change (fn [obj]
                        (let [new-val (-> obj
                                          .-target
                                          .-value)]
                          (reset! app-state
                                  (assoc @app-state
                                    :input-value new-val))))}])

(defn start-time-input [app-state]
  [:input {:type      "text"
           :value     (get @app-state :starttime:hh:mm:ss)
           :on-change #(reset! app-state
                               (assoc @app-state
                                 :starttime:hh:mm:ss (-> % .-target .-value)))}])

(defn convert-button [app-state]
  [:input {:type     "button"
           :value    "Convert to tcx"
           :on-click (fn []
                       (let [input-value (as-> (get @app-state :input-value) $
                                               (.parse js/JSON $)
                                               (js->clj $)
                                               (get $ "data"))
                             starttime:hh:mm:ss (get @app-state :starttime:hh:mm:ss)]
                         (as-> (conv/raw-data->tcx-map input-value starttime:hh:mm:ss) $
                               ;(do (println $)
                               ;    $)

                               (do (#(reset! app-state
                                             (assoc @app-state
                                               :intermediate-xml-obj $)))
                                   $)

                               (emit/emit-xml-obj $)
                               (#(reset! app-state
                                         (assoc @app-state
                                           :output $)))
                               (download "output-web.tcx" (get @app-state :output)))))}])


(defn wellness2tcx-component []
  [:div
   [:h1 "Welcome to wellness2tcx converter"]
   [:p "Input the mywellness json: " [json-input app-state]]
   [:p "Input the starttime on hh:mm:ss: " [start-time-input app-state]]
   [:p [convert-button app-state]]
   [:h3 "app-state"
    [:p (-> @app-state
            (keys)
            (str))]
    [:p (-> @app-state
            (str))]
    ]])



(reagent/render-component [wellness2tcx-component]
                          (. js/document (getElementById "app")))

(defn on-js-reload []
  ;; optionally touch your app-state to force rerendering depending on
  ;; your application
  ;; (swap! app-state update-in [:__figwheel_counter] inc)
  )
